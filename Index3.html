<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåø Zone A Battle System</title>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
      color: #f2f2f2;
      text-align: center;
      padding: 20px;
      margin: 0;
      min-height: 100vh;
    }
    h1 { text-shadow: 0 0 20px rgba(0,255,100,0.5); margin-bottom: 10px; }
    #result, #battle-log {
      background: rgba(30,30,30,0.9);
      border-radius: 15px;
      padding: 25px;
      margin: 20px auto;
      width: 95%; max-width: 700px;
      box-shadow: 0 8px 32px rgba(0,255,100,0.3);
      border: 2px solid rgba(0,255,100,0.2);
      backdrop-filter: blur(10px);
    }
    button {
      background: linear-gradient(90deg,#4caf50,#81c784);
      color: #fff;
      border: none;
      padding: 12px 24px;
      margin: 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 16px; font-weight: bold;
      box-shadow: 0 4px 15px rgba(76,175,80,0.4);
    }
    button:hover { transform: scale(1.08); box-shadow: 0 6px 20px rgba(76,175,80,0.6); }
    button:active { transform: scale(0.95); }
    .monster-stat {
      display: inline-block; margin: 5px 10px; padding: 5px 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 5px; font-size: 14px;
    }
    .class-card { background: rgba(40,40,40,0.9); border: 2px solid rgba(100,255,150,0.3);
      border-radius: 12px; padding: 15px; cursor: pointer; transition: all 0.3s;
    }
    .class-card:hover {
      transform: translateY(-5px);
      border-color: rgba(100,255,150,0.8);
      box-shadow: 0 8px 25px rgba(100,255,150,0.4);
    }
    .class-card h3 { margin: 5px 0; color: #81c784; }
    .action-result {
      background: rgba(255,100,100,0.15);
      border-left: 4px solid #f44336;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <h1>üåø Zone A ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÄ‡∏•‡πÄ‡∏ß‡∏•</h1>
  <div id="class-selection">
    <h2 style="color:#81c784;">üé≠ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:15px;max-width:900px;margin:0 auto;">
      <div class="class-card" onclick="selectClass('warrior')">
        <h3>‚öîÔ∏è Warrior</h3><p>‡∏ô‡∏±‡∏Å‡∏£‡∏ö</p><p>HP 120 | ATK 12 | DEF 10 | MAG 4</p><p>Passive: ‡∏î‡∏≤‡πÄ‡∏°‡∏à +10% ‡πÄ‡∏°‡∏∑‡πà‡∏≠ HP < 50%</p>
      </div>
      <div class="class-card" onclick="selectClass('ranger')">
        <h3>üèπ Ranger</h3><p>‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤</p><p>HP 90 | ATK 9 | DEF 6 | SPD 8</p><p>Passive: ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏´‡∏•‡∏ö 20%</p>
      </div>
      <div class="class-card" onclick="selectClass('mage')">
        <h3>‚ú® Mage</h3><p>‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó</p><p>HP 80 | ATK 6 | MAG 12 | DEF 5</p><p>Passive: ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏ó‡∏ü‡∏∑‡πâ‡∏ô HP 5</p>
      </div>
    </div>
  </div>

  <div id="result" style="display:none;"></div>
  <div id="battle-log" style="display:none;"></div>
  <button id="draw-btn" style="display:none;" onclick="startBattle()">üé¥ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ</button>
  <button id="passive-btn" style="display:none;" onclick="checkPassive()">üé≤ ‡∏™‡∏∏‡πà‡∏° Passive</button>

  <script>
    const classes = {
      warrior: {name:'‚öîÔ∏è Warrior',HP:120,ATK:12,DEF:10,MAG:4,SPD:4,LUCK:2,passive:'damageBoost'},
      ranger: {name:'üèπ Ranger',HP:90,ATK:9,DEF:6,MAG:5,SPD:8,LUCK:5,passive:'dodge'},
      mage: {name:'‚ú® Mage',HP:80,ATK:6,DEF:5,MAG:12,SPD:6,LUCK:3,passive:'heal'}
    };
    let player=null, playerLV=1, playerEXP=0, expToNext=100;
    let monster=null;

    function selectClass(type){
      player=JSON.parse(JSON.stringify(classes[type]));
      document.getElementById('class-selection').style.display='none';
      document.getElementById('draw-btn').style.display='inline-block';
      document.getElementById('passive-btn').style.display='inline-block';
      updateInfo("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏ä‡∏µ‡∏û "+player.name+" ‡πÅ‡∏•‡πâ‡∏ß!");
    }

    function updateInfo(text){
      const box=document.getElementById('result');
      box.style.display='block';
      box.innerHTML=`<h3>${text}</h3>
        <p>LV: ${playerLV} | EXP: ${playerEXP}/${expToNext}</p>
        <p>‚ù§Ô∏è HP: ${player.HP} | ‚öîÔ∏è ATK: ${player.ATK} | üõ°Ô∏è DEF: ${player.DEF} | ‚ú® MAG: ${player.MAG}</p>`;
    }

    const monsters=[
      {name:'üü© Sproutkin',HP:40,ATK:8,DEF:4,MAG:3,EXP:15},
      {name:'üü´ Ironleaf Beetle',HP:60,ATK:10,DEF:8,MAG:2,EXP:25},
      {name:'üü¶ Vine Wolf',HP:80,ATK:12,DEF:6,MAG:4,EXP:35}
    ];

    function startBattle(){
      monster = monsters[Math.floor(Math.random()*monsters.length)];
      let log=`<h2>‚öîÔ∏è ‡∏û‡∏ö ${monster.name}</h2>`;
      const playerDmg=Math.max(0,Math.floor((player.ATK*1.5)-monster.DEF));
      const monDmg=Math.max(0,Math.floor((monster.ATK*1.5)-player.DEF));
      let playerHP=player.HP-monDmg;
      let monHP=monster.HP-playerDmg;
      let critChance=Math.min(25,player.LUCK*3);
      if(Math.random()*100<critChance){monHP-=player.ATK;log+="<p>üí• Critical Hit!</p>";}
      if(monHP<=0&&playerHP>0){
        playerEXP+=monster.EXP;
        if(playerEXP>=expToNext){ levelUp(); }
        log+=`<p style="color:#4caf50;">‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞ ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö EXP ${monster.EXP}</p>`;
      }else if(playerHP<=0&&monHP>0){
        log+=`<p style="color:#f44336;">‡∏Ñ‡∏∏‡∏ì‡∏û‡πà‡∏≤‡∏¢‡πÅ‡∏û‡πâ... HP ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 0</p>`;
      }else{
        log+=`<p>‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà‡∏¢‡∏±‡∏á‡∏¢‡∏∑‡∏ô‡∏≠‡∏¢‡∏π‡πà! Player HP: ${playerHP} | Monster HP: ${monHP}</p>`;
      }
      const battle=document.getElementById('battle-log');
      battle.style.display='block'; battle.innerHTML=log;
      updateInfo("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏™‡∏π‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î");
    }

    function levelUp(){
      playerLV++;
      playerEXP=0;
      expToNext+=50;
      player.HP+=10; player.ATK+=2; player.DEF+=1;
      updateInfo("üéâ ‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏õ‡πÄ‡∏õ‡πá‡∏ô LV "+playerLV+"!");
    }

    function checkPassive(){
      let msg="";
      switch(player.passive){
        case 'damageBoost':
          if(player.HP<player.HP/2 && Math.random()<0.8) msg="‚öîÔ∏è ‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏° +10%!";
          else msg="‚ùå Passive ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
          break;
        case 'dodge':
          msg=Math.random()<0.2?"üèπ ‡∏´‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÑ‡∏î‡πâ!":"‚ùå Passive ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
          break;
        case 'heal':
          msg=Math.random()<0.5?"‚ú® ‡∏ü‡∏∑‡πâ‡∏ô HP 5 ‡∏´‡∏ô‡πà‡∏ß‡∏¢":"‚ùå Passive ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô";
          break;
      }
      document.getElementById('battle-log').innerHTML=`<p>${msg}</p>`;
    }
  </script>
</body>
</html>
      margin: 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(76,175,80,0.4);
    }
    button:hover { 
      transform: scale(1.08); 
      box-shadow: 0 6px 20px rgba(76,175,80,0.6);
    }
    button:active {
      transform: scale(0.95);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: scale(1);
    }
    #action-buttons button:nth-child(1) {
      background: linear-gradient(90deg,#f44336,#e57373);
    }
    #action-buttons button:nth-child(2) {
      background: linear-gradient(90deg,#2196f3,#64b5f6);
    }
    #player-action-buttons button:nth-child(1) {
      background: linear-gradient(90deg,#ff9800,#ffb74d);
    }
    #player-action-buttons button:nth-child(2) {
      background: linear-gradient(90deg,#9c27b0,#ba68c8);
    }
    #player-action-buttons button:nth-child(3) {
      background: linear-gradient(90deg,#00bcd4,#4dd0e1);
    }
    .monster-stat {
      display: inline-block;
      margin: 5px 10px;
      padding: 5px 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 5px;
      font-size: 14px;
    }
    .skill-box {
      background: rgba(100,255,150,0.1);
      border-left: 4px solid #4caf50;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      text-align: left;
    }
    .action-result {
      background: rgba(255,100,100,0.15);
      border-left: 4px solid #f44336;
      padding: 15px;
      margin: 15px 0;
      border-radius: 8px;
      animation: slideIn 0.4s ease-out;
    }
    .class-card {
      background: rgba(40,40,40,0.9);
      border: 2px solid rgba(100,255,150,0.3);
      border-radius: 12px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    .class-card:hover {
      transform: translateY(-5px);
      border-color: rgba(100,255,150,0.8);
      box-shadow: 0 8px 25px rgba(100,255,150,0.4);
    }
    .class-card h3 {
      margin: 5px 0;
      color: #81c784;
    }
    .class-stats {
      font-size: 13px;
      color: #ccc;
      margin: 10px 0;
      line-height: 1.6;
    }
    .class-passive {
      background: rgba(100,255,150,0.15);
      border-radius: 5px;
      padding: 8px;
      font-size: 12px;
      color: #a5d6a7;
      margin-top: 10px;
    }
    #player-info {
      background: rgba(50,50,50,0.9);
      border: 2px solid rgba(100,200,255,0.4);
      border-radius: 10px;
      padding: 15px;
      margin: 0 auto 20px;
      max-width: 700px;
    }
    .hp-bar {
      width: 100%;
      height: 25px;
      background: rgba(50,50,50,0.8);
      border-radius: 12px;
      overflow: hidden;
      margin: 10px 0;
      border: 2px solid rgba(255,255,255,0.2);
    }
    .hp-fill {
      height: 100%;
      background: linear-gradient(90deg, #f44336, #e57373);
      transition: width 0.5s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 14px;
    }
    .hp-fill.player {
      background: linear-gradient(90deg, #4caf50, #81c784);
    }
    .damage-number {
      color: #ff5252;
      font-size: 24px;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(255,82,82,0.8);
      animation: damageFloat 0.6s ease-out;
    }
    @keyframes damageFloat {
      0% { transform: translateY(0); opacity: 1; }
      100% { transform: translateY(-20px); opacity: 0; }
    }
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .spd-roll {
      font-size: 18px;
      color: #81c784;
      font-weight: bold;
      margin: 10px 0;
    }
    .level-up {
      background: linear-gradient(90deg, #ffd700, #ffed4e);
      color: #000;
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      font-weight: bold;
      animation: pulse 0.5s ease-in-out;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    .battle-log {
      background: rgba(20,20,20,0.8);
      border-radius: 8px;
      padding: 10px;
      margin: 15px 0;
      max-height: 200px;
      overflow-y: auto;
      text-align: left;
      font-size: 13px;
    }
    .battle-log p {
      margin: 5px 0;
      padding: 5px;
      border-left: 3px solid #4caf50;
      padding-left: 10px;
    }
    .passive-check {
      background: rgba(255,193,7,0.2);
      border: 2px solid #ffc107;
      border-radius: 8px;
      padding: 12px;
      margin: 15px 0;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>üåø Zone A Monster ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏™‡∏Å‡∏¥‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô</h1>
  <p style="color: #aaa; margin-top: -5px;">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ï‡πà‡∏≠‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô</p>
  
  <div id="class-selection" style="display:block;">
    <h2 style="color:#81c784; margin-bottom:20px;">üé≠ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏ä‡∏µ‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:15px; max-width:900px; margin:0 auto 20px;">
      <div class="class-card" onclick="selectClass('wanderer')">
        <h3>üó∫Ô∏è Wanderer</h3>
        <p style="font-size:12px; color:#aaa;">‡∏ô‡∏±‡∏Å‡∏û‡πÄ‡∏ô‡∏à‡∏£</p>
        <div class="class-stats">
          HP: 100 | ATK: 10 | DEF: 8<br>
          MAG: 6 | SPD: 5 | LUCK: 3
        </div>
        <div class="class-passive">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ Dice +2 = 10%</div>
      </div>
      <div class="class-card" onclick="selectClass('warrior')">
        <h3>‚öîÔ∏è Warrior</h3>
        <p style="font-size:12px; color:#aaa;">‡∏ô‡∏±‡∏Å‡∏£‡∏ö</p>
        <div class="class-stats">
          HP: 120 | ATK: 12 | DEF: 10<br>
          MAG: 4 | SPD: 4 | LUCK: 2
        </div>
        <div class="class-passive">‡∏î‡∏≤‡πÄ‡∏°‡∏à +10% ‡πÄ‡∏°‡∏∑‡πà‡∏≠ HP < 50%</div>
      </div>
      <div class="class-card" onclick="selectClass('ranger')">
        <h3>üèπ Ranger</h3>
        <p style="font-size:12px; color:#aaa;">‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤</p>
        <div class="class-stats">
          HP: 90 | ATK: 9 | DEF: 6<br>
          MAG: 5 | SPD: 8 | LUCK: 5
        </div>
        <div class="class-passive">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏´‡∏•‡∏ö 20%</div>
      </div>
      <div class="class-card" onclick="selectClass('mage')">
        <h3>‚ú® Mage</h3>
        <p style="font-size:12px; color:#aaa;">‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó</p>
        <div class="class-stats">
          HP: 80 | ATK: 6 | DEF: 5<br>
          MAG: 12 | SPD: 6 | LUCK: 3
        </div>
        <div class="class-passive">‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏ó‡∏ü‡∏∑‡πâ‡∏ô HP 5</div>
      </div>
      <div class="class-card" onclick="selectClass('cleric')">
        <h3>üôè Cleric</h3>
        <p style="font-size:12px; color:#aaa;">‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä</p>
        <div class="class-stats">
          HP: 90 | ATK: 7 | DEF: 7<br>
          MAG: 10 | SPD: 5 | LUCK: 4
        </div>
        <div class="class-passive">Heal +25% ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™</div>
      </div>
      <div class="class-card" onclick="selectClass('engineer')">
        <h3>‚öôÔ∏è Engineer</h3>
        <p style="font-size:12px; color:#aaa;">‡∏ä‡πà‡∏≤‡∏á‡∏ô‡∏≤‡πÇ‡∏ô</p>
        <div class="class-stats">
          HP: 100 | ATK: 8 | DEF: 8<br>
          MAG: 6 | SPD: 5 | LUCK: 3
        </div>
        <div class="class-passive">‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡πÇ‡∏ã‡∏ô</div>
      </div>
    </div>
  </div>

  <div id="result" style="display:none;">
    <p style="font-size: 18px; color: #81c784;">‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏±‡πà‡∏ß‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå</p>
    <p style="font-size: 14px; color: #888;">‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏ö‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå 60%</p>
  </div>
  <button id="draw-btn" onclick="drawEncounter()" style="display:none;">üé¥ ‡∏à‡∏±‡πà‡∏ß‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå</button>
  <div id="player-action-buttons" style="display:none;">
    <button onclick="playerAction('attack')">‚öîÔ∏è ‡πÇ‡∏à‡∏°‡∏ï‡∏µ</button>
    <button onclick="playerAction('magic')">‚ú® ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏ó</button>
    <button onclick="playerAction('guard')">üõ°Ô∏è ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</button>
    <button onclick="checkPassive()" style="background: linear-gradient(90deg,#ffc107,#ffd54f);">üé≤ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏Å‡∏¥‡∏• Passive</button>
  </div>
  <div id="action-buttons" style="display:none;">
    <button onclick="chooseAction('attack')">‚öîÔ∏è ‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÇ‡∏à‡∏°‡∏ï‡∏µ</button>
    <button onclick="chooseAction('guard')">üõ°Ô∏è ‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô</button>
  </div>

  <script>
    const classes = {
      wanderer: { name: 'üó∫Ô∏è Wanderer (‡∏ô‡∏±‡∏Å‡∏û‡πÄ‡∏ô‡∏à‡∏£)', HP: 100, ATK: 10, DEF: 8, MAG: 6, SPD: 5, LUCK: 3, passive: '‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ Dice +2 = 10%', passiveChance: 0.1 },
      warrior: { name: '‚öîÔ∏è Warrior (‡∏ô‡∏±‡∏Å‡∏£‡∏ö)', HP: 120, ATK: 12, DEF: 10, MAG: 4, SPD: 4, LUCK: 2, passive: '‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏° +10% ‡πÄ‡∏°‡∏∑‡πà‡∏≠ HP < 50%', passiveChance: 1.0 },
      ranger: { name: 'üèπ Ranger (‡∏ô‡∏±‡∏Å‡∏•‡πà‡∏≤)', HP: 90, ATK: 9, DEF: 6, MAG: 5, SPD: 8, LUCK: 5, passive: '‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 20% ‡∏´‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ', passiveChance: 0.2 },
      mage: { name: '‚ú® Mage (‡∏à‡∏≠‡∏°‡πÄ‡∏ß‡∏ó)', HP: 80, ATK: 6, DEF: 5, MAG: 12, SPD: 6, LUCK: 3, passive: '‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏ó ‡∏ü‡∏∑‡πâ‡∏ô HP 5', passiveChance: 1.0 },
      cleric: { name: 'üôè Cleric (‡∏ô‡∏±‡∏Å‡∏ö‡∏ß‡∏ä)', HP: 90, ATK: 7, DEF: 7, MAG: 10, SPD: 5, LUCK: 4, passive: 'Heal Spell ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° 25%', passiveChance: 0.25 },
      engineer: { name: '‚öôÔ∏è Engineer (‡∏ä‡πà‡∏≤‡∏á‡∏ô‡∏≤‡πÇ‡∏ô)', HP: 100, ATK: 8, DEF: 8, MAG: 6, SPD: 5, LUCK: 3, passive: '‡πÉ‡∏ä‡πâ‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡πÑ‡∏î‡πâ‡∏ü‡∏£‡∏µ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÇ‡∏ã‡∏ô', passiveChance: 1.0 }
    };

    window.gameState = {
      player: null,
      monster: null,
      playerMaxHP: 0,
      monsterMaxHP: 0,
      level: 1,
      exp: 0,
      expToNext: 50,
      battleLog: [],
      turn: 0,
      playerDefending: false,
      monsterDefending: false,
      freeItemUsed: false
    };

    function selectClass(classType) {
      const cls = classes[classType];
      window.gameState.player = {
        ...cls,
        currentHP: cls.HP,
        baseHP: cls.HP,
        baseATK: cls.ATK,
        baseDEF: cls.DEF,
        baseMAG: cls.MAG,
        baseSPD: cls.SPD
      };
      window.gameState.playerMaxHP = cls.HP;
      
      document.getElementById('class-selection').style.display = 'none';
      
      const playerInfo = document.createElement('div');
      playerInfo.id = 'player-info';
      playerInfo.innerHTML = `
        <h3 style="color:#64b5f6; margin:0 0 10px 0;">${cls.name} | LV ${window.gameState.level}</h3>
        <div class="hp-bar">
          <div class="hp-fill player" id="player-hp-bar" style="width:100%;">
            ${cls.HP} / ${cls.HP}
          </div>
        </div>
        <div style="margin:10px 0;">
          <span class="monster-stat">‚öîÔ∏è ATK: ${cls.ATK}</span>
          <span class="monster-stat">üõ°Ô∏è DEF: ${cls.DEF}</span>
          <span class="monster-stat">‚ú® MAG: ${cls.MAG}</span>
          <span class="monster-stat">‚ö° SPD: ${cls.SPD}</span>
          <span class="monster-stat">üçÄ LUCK: ${cls.LUCK}</span>
        </div>
        <div style="margin:10px 0;">
          <span class="monster-stat">üí´ EXP: ${window.gameState.exp} / ${window.gameState.expToNext}</span>
        </div>
        <div class="skill-box" style="border-left-color:#64b5f6;">
          <b>Passive:</b> ${cls.passive}
        </div>
      `;
      
      document.body.insertBefore(playerInfo, document.getElementById('result'));
      document.getElementById('result').style.display = 'block';
      document.getElementById('draw-btn').style.display = 'inline-block';
    }

    const monsters = [
      { name: 'üü© A1 Sproutkin', LV: 1, HP: 40, ATK: 8, DEF: 4, MAG: 3, SPD: 4, EXP: 15, Drop: 'Leaf Seed', 
        passive: 'üå± Poison Tap ‚Äî ‡πÇ‡∏à‡∏°‡∏ï‡∏µ 1.5√ó ATK, ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 30% ‡∏ï‡∏¥‡∏î‡∏û‡∏¥‡∏©', weight: 4, 
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 50, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 10, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Poison Tap', chance: 25, desc: '‡∏î‡∏≤‡πÄ‡∏°‡∏à √ó1.5 ATK, ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡∏¥‡∏î‡∏û‡∏¥‡∏© 30%'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Root Slam', chance: 15, desc: '(ATK + MAG) √ó 2 - DEF'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 60, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå (‡∏Å‡∏±‡∏ô‡∏≠‡∏±‡∏•‡∏ï‡∏¥)', chance: 30, desc: 'DEF √ó 2 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 10, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏ß‡∏ó 70%'}
        ]},
      { name: 'üü´ A2 Ironleaf Beetle', LV: 2, HP: 60, ATK: 10, DEF: 8, MAG: 2, SPD: 3, EXP: 25, Drop: 'Iron Shard',
        passive: 'ü™≤ Iron Charge ‚Äî (ATK √ó 1.8) - DEF, ‡πÄ‡∏û‡∏¥‡πà‡∏° DEF +3 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏´‡∏ô‡πâ‡∏≤', weight: 4,
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 40, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 10, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Iron Charge', chance: 25, desc: '(ATK √ó 1.8) - DEF / ‡πÄ‡∏û‡∏¥‡πà‡∏° DEF +3 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Steel Drill', chance: 25, desc: '(ATK + MAG) √ó 2 - DEF'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 50, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', chance: 40, desc: 'DEF √ó 2 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏î‡∏ô‡∏≠‡∏±‡∏•‡∏ï‡∏¥'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 10, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏ß‡∏ó 70%'}
        ]},
      { name: 'üü¶ A3 Vine Wolf', LV: 3, HP: 80, ATK: 12, DEF: 6, MAG: 4, SPD: 6, EXP: 35, Drop: 'Wolf Pelt',
        passive: 'üê∫ Double Bite ‚Äî ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÇ‡∏à‡∏°‡∏ï‡∏µ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á, ‡πÅ‡∏ï‡πà DEF ‡∏•‡∏î‡∏•‡∏á 2 ‡πÉ‡∏ô‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏ô‡∏±‡πâ‡∏ô', weight: 4,
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 40, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 15, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Double Bite', chance: 30, desc: '‡πÇ‡∏à‡∏°‡∏ï‡∏µ 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á, DEF -2 ‡πÉ‡∏ô‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô‡∏ô‡∏±‡πâ‡∏ô'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Howl of Roots', chance: 15, desc: '(ATK √ó 2) - DEF / ‡∏•‡∏î DEF ‡∏®‡∏±‡∏ï‡∏£‡∏π 2 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 70, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', chance: 20, desc: 'DEF √ó 2 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 10, desc: '‡∏•‡∏î‡πÄ‡∏ß‡∏ó 70%'}
        ]},
      { name: 'üü™ A4 Sprout Mage', LV: 3, HP: 55, ATK: 8, DEF: 5, MAG: 10, SPD: 5, EXP: 30, Drop: 'Mana Fruit',
        passive: 'üçÑ Poison Mist ‚Äî (MAG √ó 1.8) - (MAG ‡∏ù‡πà‡∏≤‡∏¢‡∏£‡∏±‡∏ö √ó 0.8), ‡∏ï‡∏¥‡∏î‡∏û‡∏¥‡∏© 50%', weight: 4,
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 20, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 40, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Poison Mist', chance: 25, desc: '‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏ß‡∏ó, ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ï‡∏¥‡∏î‡∏û‡∏¥‡∏© 50%'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Venom Storm', chance: 15, desc: '(MAG √ó 2.2) - (MAG ‡∏£‡∏±‡∏ö √ó 0.8), ‡∏û‡∏¥‡∏©‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 40, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', chance: 10, desc: 'DEF √ó 2 (‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏ô‡πÄ‡∏ß‡∏ó‡πÑ‡∏î‡πâ)'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 50, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à‡πÄ‡∏ß‡∏ó 70%'}
        ]},
      { name: 'üü® A5 Nano Sprig', LV: 2, HP: 50, ATK: 9, DEF: 5, MAG: 8, SPD: 5, EXP: 20, Drop: 'Nano Core',
        passive: '‚öôÔ∏è Nano Spark ‚Äî (MAG √ó 1.6) + (ATK √ó 0.5) - DEF, ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏•‡∏î DEF ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 1 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô', weight: 4,
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 30, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 30, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Nano Spark', chance: 25, desc: '‡∏ú‡∏™‡∏° ATK+MAG, ‡∏•‡∏î DEF ‡∏®‡∏±‡∏ï‡∏£‡∏π 1 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Nano Burst', chance: 15, desc: '(ATK + MAG) √ó 2 - DEF'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 50, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', chance: 25, desc: 'DEF √ó 2'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 25, desc: '‡∏•‡∏î‡πÄ‡∏ß‡∏ó 70%'}
        ]},
      { name: 'üü• A6 Event Beast', LV: '‚Äî', HP: 100, ATK: 14, DEF: 8, MAG: 6, SPD: 5, EXP: 40, Drop: 'Fragment 1',
        passive: 'üíÄ Root Breaker ‚Äî (ATK + MAG) √ó 2 - DEF, ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™ 50% ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ "‡∏á‡∏≠‡∏Å‡∏£‡∏≤‡∏Å" (‡∏Ç‡∏¢‡∏±‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ 1 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô)', weight: 1,
        attacks: [
          {name: '‡∏ï‡∏µ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤', chance: 30, desc: '(ATK √ó 1.5) - DEF'},
          {name: '‡∏ï‡∏µ‡πÄ‡∏ß‡∏ó', chance: 25, desc: '(MAG √ó 1.8) - (MAG ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏±‡∏ö √ó 0.8)'},
          {name: '‡∏™‡∏Å‡∏¥‡∏•: Root Breaker', chance: 30, desc: '(ATK + MAG) √ó 2 - DEF, ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ó‡∏≥‡πÉ‡∏´‡πâ "‡∏á‡∏≠‡∏Å‡∏£‡∏≤‡∏Å" 1 ‡πÄ‡∏ó‡∏¥‡∏£‡πå‡∏ô'},
          {name: '‡∏≠‡∏±‡∏•‡∏ï‡∏¥: Heart Drain', chance: 15, desc: '(ATK + MAG √ó 2) - DEF, ‡∏ü‡∏∑‡πâ‡∏ô HP 20% ‡∏à‡∏≤‡∏Å‡∏î‡∏≤‡πÄ‡∏°‡∏à'}
        ],
        guards: [
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥', chance: 40, desc: '‡∏•‡∏î‡∏î‡∏≤‡πÄ‡∏°‡∏à 50%'},
          {name: '‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå', chance: 40, desc: 'DEF √ó 2'},
          {name: '‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡∏ó', chance: 20, desc: '‡∏•‡∏î‡πÄ‡∏ß‡∏ó 70%'}
        ]}
    ];

    function weightedRandom(list){
      let total=list.reduce((s,i)=>s+i.weight,0);
      let r=Math.random()*total;
      for(let i of list){
        if(r<i.weight)return i;
        r-=i.weight;
      }
    }

    function weightedChoice(actions){
      let total=actions.reduce((s,a)=>s+a.chance,0);
      let r=Math.random()*total;
      for(let a of actions){
        if(r<a.chance)return a;
        r-=a.chance;
      }
    }

    function updatePlayerInfo() {
      const p = window.gameState.player;
      const hpPercent = (p.currentHP / window.gameState.playerMaxHP) * 100;
      document.getElementById('player-info').innerHTML = `
        <h3 style="color:#64b5f6; margin:0 0 10px 0;">${p.name} | LV ${window.gameState.level}</h3>
        <div class="hp-bar">
          <div class="hp-fill player" id="player-hp-bar" style="width:${hpPercent}%;">
            ${p.currentHP} / ${window.gameState.playerMaxHP}
          </div>
        </div>
        <div style="margin:10px 0;">
          <span class="monster-stat">‚öîÔ∏è ATK: ${p.ATK}</span>
          <span class="monster-stat">üõ°Ô∏è DEF: ${p.DEF}</span>
          <span class="monster-stat">‚ú® MAG: ${p.MAG}</span>
          <span class="monster-stat">‚ö° SPD: ${p.SPD}</span>
          <span class="monster-stat">üçÄ LUCK: ${p.LUCK}</span>
        </div>
        <div style="margin:10px 0;">
          <span class="monster-stat">üí´ EXP: ${window.gameState.exp} / ${window.gameState.expToNext}</span>
        </div>
        <div class="skill-box" style="border-left-color:#64b5f6;">
          <b>Passive:</b> ${p.passive}
        </div>
      `;
    }

    function updateMonsterInfo() {
      const m = window.gameState.monster;
      const hpPercent = (m.currentHP / window.gameState.monsterMaxHP) * 100;
      const monsterSection = document.getElementById('monster-section');
      if (monsterSection) {
        monsterSection.querySelector('.hp-fill').style.width = hpPercent + '%';
        monsterSection.querySelector('.hp-fill').textContent = `${m.currentHP} / ${window.gameState.monsterMaxHP}`;
      }
    }

    function addLog(message, color = '#4caf50') {
      window.gameState.battleLog.unshift(`<span style="color:${color};">${message}</span>`);
      if (window.gameState.battleLog.length > 10) window.gameState.battleLog.pop();
      updateBattleLog();
    }

    function updateBattleLog() {
      const logDiv = document.getElementById('battle-log');
      if (logDiv) {
        logDiv.innerHTML = window.gameState.battleLog.map(log => `<p>${log}</p>`).join('');
      }
    }

    function checkPassive() {
      const p = window.gameState.player;
      const passiveDiv = document.createElement('div');
      passiveDiv.className = 'passive-check';
      
      let result = '';
      const roll = Math.random();
      
      if (p.name.includes('Wanderer')) {
        if (roll < p.passiveChance) {
          result = '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! Dice +2 ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô!';
          addLog('?
